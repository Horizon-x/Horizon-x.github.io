<!DOCTYPE html><html lang="zh-CN"><head><link href="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.1.1/css/index.css" rel="stylesheet"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#0078E7"><meta name="author" content="ONESTONE"><meta name="copyright" content="ONESTONE"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§ | ä¸Šé€²å¿ƒçš„å°ç«™</title><link rel="stylesheet" href="https://fonts.font.im/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal(){[".post-card",".post-content img"].forEach(e=>{ScrollReveal().reveal(e)})}document.addEventListener("DOMContentLoaded",initScrollReveal),document.addEventListener("pjax:success",initScrollReveal)</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded",()=>{Yun.utils.renderKatex()})</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme:light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme:dark)"><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><script id="yun-config">const Yun=window.Yun||{};window.CONFIG={hostname:"www.onexstone.online",root:"/",title:"ä¸Šé€²å¿ƒçš„å°ç«™",version:"1.6.2",mode:"auto",copycode:!0,page:{isPost:!0},i18n:{placeholder:"Search or jump to...",empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}",hits:"æ‰¾åˆ° ${hits} æ¡ç»“æœ",hits_time:"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},anonymous_image:"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg",say:{api:"https://v1.hitokoto.cn",hitokoto:!0},local_search:{path:"/search.xml"},fireworks:{colors:["102, 167, 221","62, 131, 225","33, 78, 194"]}}</script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="ä¸Šé€²å¿ƒçš„å°ç«™" type="application/atom+xml"><script src="/js/custom/change-site-title.js" defer></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><meta name="description" content="è¯¦ç»†é˜è¿°Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰å¥—ç­–ç•¥"><meta property="og:type" content="article"><meta property="og:title" content="Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§"><meta property="og:url" content="https://www.onexstone.online/posts/cf2f473d/index.html"><meta property="og:site_name" content="ä¸Šé€²å¿ƒçš„å°ç«™"><meta property="og:description" content="è¯¦ç»†é˜è¿°Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰å¥—ç­–ç•¥"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-10-01T12:59:31.000Z"><meta property="article:modified_time" content="2021-10-15T12:10:20.493Z"><meta property="article:author" content="ONESTONE"><meta property="article:tag" content="JVM"><meta property="article:tag" content="Java"><meta property="article:tag" content="çº¿ç¨‹å®‰å…¨"><meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script><script src="/js/webpushr/webpushr-sw.js"></script><script src="/js/fancybox/jquery.min.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ONESTONE"><img width="96" loading="lazy" src="https://cdn.jsdelivr.net/gh/horizon-x/imagesCDN/img/avatar-auther.png" alt="ONESTONE"><span class="site-author-status" title="æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ">ğŸ˜Š</span></a><div class="site-author-name"><a href="/about/">ONESTONE</a></div><span class="site-name">ä¸Šé€²å¿ƒçš„å°ç«™</span><sub class="site-subtitle">Miracles happen every day.</sub><div class="site-desciption">æ—¢ç„¶é€‰æ‹©äº†è¿œæ–¹ï¼Œä¾¿åªé¡¾é£é›¨å…¼ç¨‹</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">11</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">11</span></a></div><a class="site-state-item hty-icon-button" href="/shuoshuo/" title="TZone"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://z3.ax1x.com/2021/09/25/4sPUZF.png" title="QQ" target="_blank" style="color:#12b7f5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Horizon-x" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="http://music.163.com/m/user/home?id=107106147" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#c20c0c"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://b23.tv/vfwGMM" title="bilibili" target="_blank" style="color:#ff8eb3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://my.oschina.net/onexstone" title="OSCHINA" target="_blank" style="color:#08c"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-fill"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://z3.ax1x.com/2021/09/24/4DSw9K.png" title="å¾®ä¿¡å…¬ä¼—å·" target="_blank" style="color:#1aad19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:paoxbin@qq.com" title="E-Mail" target="_blank" style="color:#8e71c1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/albums/" title="Time Machine" style="color:#1e90ff"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gallery-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color:#f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E6%9D%BF%E6%96%A7%E4%B9%8B%E4%B8%80%EF%BC%9A%E4%BA%92%E6%96%A5%E5%90%8C%E6%AD%A5"><span class="toc-number">2.</span> <span class="toc-text">ä¸‰æ¿æ–§ä¹‹ä¸€ï¼šäº’æ–¥åŒæ­¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#synchronized-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">2.1.</span> <span class="toc-text">synchronized å…³é”®å­—</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E6%9D%BF%E6%96%A7%E4%B9%8B%E4%BA%8C%EF%BC%9A%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%90%8C%E6%AD%A5"><span class="toc-number">3.</span> <span class="toc-text">ä¸‰æ¿æ–§ä¹‹äºŒï¼šéé˜»å¡åŒæ­¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E6%9D%BF%E6%96%A7%E4%B9%8B%E4%B8%89%EF%BC%9A%E6%97%A0%E5%90%8C%E6%AD%A5%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8"><span class="toc-number">4.</span> <span class="toc-text">ä¸‰æ¿æ–§ä¹‹ä¸‰ï¼šæ— åŒæ­¥çº¿ç¨‹å®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">6.</span> <span class="toc-text">å‚è€ƒæ–‡çŒ®</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://www.onexstone.online/posts/cf2f473d/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ONESTONE"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="ä¸Šé€²å¿ƒçš„å°ç«™"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span><time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-01 20:59:31" itemprop="dateCreated datePublished" datetime="2021-10-01T20:59:31+08:00">2021-10-01</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span><time title="ä¿®æ”¹æ—¶é—´ï¼š2021-10-15 20:10:20" itemprop="dateModified" datetime="2021-10-15T20:10:20+08:00">2021-10-15</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span><span title="æœ¬æ–‡å­—æ•°">3.2k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span><span title="é˜…è¯»æ—¶é•¿">12m</span></span></span><span class="leancloud_visitors" id="/posts/cf2f473d/" data-flag-title="Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="è¯„è®ºæ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-chat-3-line"></use></svg> <span class="waline-comment-count" id="/posts/cf2f473d/"></span></span></a><div class="post-classify"><span class="post-category"><span class="post-meta-item-icon" style="margin-right:3px"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Java/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Java</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Java/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Javaå¹¶å‘ç¼–ç¨‹</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/JVM/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">JVM</span></a><a class="tag-item" href="/tags/Java/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Java</span></a><a class="tag-item" href="/tags/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">çº¿ç¨‹å®‰å…¨</span></a></span></div><div class="post-author"><span class="author-name">ONESTONE</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7"><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ç°åœ¨ï¼Œå¦‚æœè¦ä½¿ç”¨ Java å®ç°ä¸€æ®µçº¿ç¨‹å®‰å…¨çš„ä»£ç ï¼Œå¤§è‡´æœ‰ synchronized ã€ java.util.concurrent åŒ…ç­‰æ‰‹æ®µã€‚è™½ç„¶å¤§å®¶éƒ½ä¼šç”¨ï¼Œä½†å´ä¸ä¸€å®šçœŸæ­£æ¸…æ¥šå…¶åœ¨ JVM å±‚é¢ä¸Šçš„å®ç°åŸç†ï¼Œå› æ­¤ï¼Œç¬”è€…åœ¨æŸ¥é˜…äº†ä¸€äº›èµ„æ–™åï¼Œå¸Œæœ›æŠŠè‡ªå·±å¯¹æ­¤çš„ä¸€äº›è§è§£åˆ†äº«ç»™å¤§å®¶ã€‚</p><span id="more"></span><h3 id="ä¸‰æ¿æ–§ä¹‹ä¸€ï¼šäº’æ–¥åŒæ­¥"><a href="#ä¸‰æ¿æ–§ä¹‹ä¸€ï¼šäº’æ–¥åŒæ­¥" class="headerlink" title="ä¸‰æ¿æ–§ä¹‹ä¸€ï¼šäº’æ–¥åŒæ­¥"></a>ä¸‰æ¿æ–§ä¹‹ä¸€ï¼šäº’æ–¥åŒæ­¥</h3><ul><li>äº’æ–¥åŒæ­¥ï¼šä½¿ç”¨äº’æ–¥çš„æ‰‹æ®µæ¥ä¿è¯åŒæ­¥æ“ä½œã€‚äº’æ–¥æ˜¯æ–¹æ³•ï¼ŒåŒæ­¥æ˜¯ç›®çš„ã€‚</li><li>åœ¨ Java çš„ä¸–ç•Œé‡Œï¼Œæœ€åŸºæœ¬çš„äº’æ–¥åŒæ­¥æ‰‹æ®µå°±æ˜¯ä½¿ç”¨ synchronized å…³é”®å­—ã€‚</li></ul><h4 id="synchronized-å…³é”®å­—"><a href="#synchronized-å…³é”®å­—" class="headerlink" title="synchronized å…³é”®å­—"></a>synchronized å…³é”®å­—</h4><ol><li><p>synchronized èƒ½å®ç°åŒæ­¥çš„ç†è®ºåŸºç¡€æ˜¯ï¼šJava ä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ã€‚</p></li><li><p>synchronized å…³é”®å­—åœ¨ä¸åŒçš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œä½œä¸ºé”çš„å¯¹è±¡æœ‰æ‰€ä¸åŒï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p><ul><li>å¯¹äºåŒæ­¥ä»£ç å—ï¼Œé”å°±æ˜¯å£°æ˜ synchronized åŒæ­¥å—æ—¶æŒ‡å®šçš„å¯¹è±¡ï¼ˆsynchronized æ‹¬å·ä¸­é…ç½®çš„å¯¹è±¡ï¼‰ï¼›</li><li>å¯¹äºæ™®é€šå¯¹è±¡æ–¹æ³•ï¼Œé”å°±æ˜¯å½“å‰çš„å®ä¾‹å¯¹è±¡ï¼›</li><li>å¯¹äºé™æ€åŒæ­¥å—ï¼Œé”å°±æ˜¯å½“å‰ç±»çš„ Class å¯¹è±¡ã€‚</li></ul></li><li><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€æ®µä»£ç æ¥è¿›ä¸€æ­¥è¯´æ˜ synchronized æ˜¯å¦‚ä½•å®ç°äº’æ–¥åŒæ­¥çš„ã€‚</p></li></ol><ul><li><p>ç¤ºä¾‹ä»£ç </p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public class SynchronizedTest &#123;
    public void test() &#123;
        synchronized (this) &#123;
            try &#123;
                System.out.println(&quot;SynchronizedTest.test() method start!&quot;);
            &#125; catch (Exception e) &#123;

            &#125;
        &#125;
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯¹ä¸Šè¿°ä»£ç ç”Ÿæˆçš„å­—èŠ‚ç ä½¿ç”¨ Javap è¿›è¡Œåç¼–è¯‘ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">Compiled from &quot;SynchronizedTest.java&quot;
public class com.xxx.JVMTest.SynchronizedTest &#123;
  public com.xxx.JVMTest.SynchronizedTest();
    Code:
       0: aload_0
       1: invokespecial #1                  &#x2F;&#x2F; Method java&#x2F;lang&#x2F;Object.&quot;&lt;init&gt;&quot;:()V
       4: return

  public void test();
    Code:
       0: aload_0
       1: dup
       2: astore_1
       3: monitorenter
       4: getstatic     #2                  &#x2F;&#x2F; Field java&#x2F;lang&#x2F;System.out:Ljava&#x2F;io&#x2F;PrintStream;
       7: ldc           #3                  &#x2F;&#x2F; String SynchronizedTest.test() method start!
       9: invokevirtual #4                  &#x2F;&#x2F; Method java&#x2F;io&#x2F;PrintStream.println:(Ljava&#x2F;lang&#x2F;String;)V
      12: aload_1
      13: monitorexit
      14: goto          22
      17: astore_2
      18: aload_1
      19: monitorexit
      20: aload_2
      21: athrow
      22: return
    Exception table:
       from    to  target type
           4    14    17   any
          17    20    17   any
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åç¼–è¯‘çš„ä»£ç ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªç”± Javac ç¼–è¯‘å™¨åŠ å…¥çš„æŒ‡ä»¤ï¼Œåˆ†åˆ«æ˜¯æ’å…¥åˆ°åŒæ­¥ä»£ç å—å¼€å§‹ä½ç½®çš„ monitorenter æŒ‡ä»¤å’Œæ’å…¥åˆ°åŒæ­¥ä»£ç å—ç»“æŸä½ç½®ä»¥åŠå¼‚å¸¸å¤„çš„ monitorexit æŒ‡ä»¤ã€‚</p></li><li><p>æ ¹æ®ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¯çŸ¥ï¼Œæ¯ä¸ª Java å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç›‘è§†å™¨é”ï¼ˆmonitorï¼‰ã€‚åœ¨æ‰§è¡Œ monitorenter æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆè¦å»å°è¯•è·å–å¯¹è±¡çš„é”ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æ²¡è¢«é”å®šï¼Œæˆ–è€…å½“å‰çº¿ç¨‹å·²ç»æŒæœ‰äº†è¯¥å¯¹è±¡çš„é”ï¼Œå°±æŠŠé”çš„è®¡æ•°å™¨çš„å€¼åŠ ä¸€ï¼Œè€Œåœ¨æ‰§è¡Œ monitorexit æŒ‡ä»¤æ—¶ä¼šå°†é”è®¡æ•°å™¨çš„å€¼å‡ä¸€ã€‚ä¸€æ—¦é”è®¡æ•°å™¨çš„å€¼ä¸ºé›¶ï¼Œé”éšå³è¢«é‡Šæ”¾ã€‚å¦‚æœå…¶ä»–çº¿ç¨‹å·²ç»å ç”¨äº†è¯¥å¯¹è±¡çš„é”ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°é”çš„è®¡æ•°å™¨ä¸ºé›¶æ—¶ï¼Œå†é‡æ–°å°è¯•è·å–è¯¥å¯¹è±¡çš„æ‰€æœ‰æƒã€‚</p></li><li><p>å› æ­¤ï¼Œ<strong>æœ¬è´¨ä¸Š JVM å°±æ˜¯é€šè¿‡è¿›å…¥ Monitor å¯¹è±¡ï¼ˆmonitorenterï¼‰ä»¥åŠé€€å‡º Monitor å¯¹è±¡ï¼ˆmonitorexitï¼‰æ¥å®ç°æ–¹æ³•å’Œä»£ç å—çš„åŒæ­¥æ“ä½œã€‚</strong></p></li></ul><ol><li>é€šè¿‡å¯¹ monitorenter æŒ‡ä»¤å’Œ monitorexit æŒ‡ä»¤çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡º synchronized çš„ä¸‰æ¡ç»“è®ºï¼š</li></ol><ul><li>è¢« synchronized å£°æ˜çš„åŒæ­¥ä»£ç å—å¯¹åŒä¸€çº¿ç¨‹è€Œè¨€æ˜¯å¯é‡å…¥çš„ï¼Œæ‰€ä»¥åŒä¸€çº¿ç¨‹é‡å¤è¿›å…¥åŒæ­¥å—ä¹Ÿä¸ä¼šå‡ºç°è¢«è‡ªå·±é”æ­»çš„æƒ…å†µï¼›</li><li>è¢« synchronized å£°æ˜çš„åŒæ­¥å—åœ¨æŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å¹¶é‡Šæ”¾é”ä¹‹å‰ï¼Œä¼šæ— æ¡ä»¶åœ°é˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ã€‚å› æ­¤æ— æ³•å®ç°å¯¹å·²ç»è·å¾—é”çš„çº¿ç¨‹å¼ºåˆ¶é‡Šæ”¾é”çš„æ“ä½œï¼Œä»¥åŠå¯¹ç­‰å¾…é”çš„çº¿ç¨‹å®ç°ä¸­æ–­ç­‰å¾…æˆ–è¶…æ—¶é€€å‡ºçš„æœºåˆ¶ã€‚</li><li>ç”±äº Java çº¿ç¨‹æ˜¯æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿçš„åŸç”Ÿå†…æ ¸çº¿ç¨‹ä¹‹ä¸Šçš„ï¼Œå¦‚æœè¦é˜»å¡æˆ–è€…å”¤é†’ä¸€æ¡çº¿ç¨‹ï¼Œåˆ™éœ€è¦æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆï¼Œè¿™ä¸å¯é¿å…åœ°é™·å…¥ç”¨æˆ·æ€åˆ°æ ¸å¿ƒæ€çš„è½¬å˜ä¹‹ä¸­ï¼Œå› æ­¤åœ¨ä¸€äº›ç»å…¸çš„ Java å¹¶å‘ç¼–ç¨‹èµ„æ–™ä¸­ï¼Œsynchronized è¢«å½¢è±¡åœ°ç§°ä¸ºé‡é‡çº§é”ã€‚ä½†å®ƒç›¸å¯¹äºåˆ©ç”¨ java.util.concurrent åŒ…ä¸­ Lock æ¥å£å®ç°çš„é”æœºåˆ¶ä»æœ‰ä¸€ä¸ªå…ˆå¤©çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯ synchronized çš„é”ä¿¡æ¯æ˜¯è¢« JVM è®°å½•åœ¨çº¿ç¨‹å’Œå¯¹è±¡çš„å…ƒæ•°æ®ä¸­çš„ï¼Œå¯ä»¥å¾ˆè½»æ˜“çš„çŸ¥é“å½“å‰å“ªäº›é”å¯¹è±¡æ˜¯è¢«å“ªäº›ç‰¹å®šçš„çº¿ç¨‹æ‰€æŒæœ‰ï¼Œä»è€Œæ›´å®¹æ˜“è¿›è¡Œé”ä¼˜åŒ–ã€‚</li></ul><ol start="5"><li>åœ¨è¿™é‡Œéœ€è¦è¡¥å……ä¸€ç‚¹çš„å°±æ˜¯ï¼ŒåŒæ­¥æ–¹æ³•è™½ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ monitorenter æŒ‡ä»¤å’Œ monitorexit æŒ‡ä»¤å®ç°åŒæ­¥æ“ä½œï¼Œä½†å®é™…ä¸Šç›®å‰çš„å®ç°ä¸­å¹¶æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹æ¡ˆ</li></ol><ul><li><p>æˆ‘ä»¬å¯ä»¥å…·ä½“åˆ†æä¸‹é¢çš„ä»£ç </p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public class SynchronizedTest &#123;
    public synchronized void testTwo() &#123;
        System.out.println(&quot;SynchronizedTest.testTwo() method start!&quot;);
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯¹ä¸Šè¿°ä»£ç ç”Ÿæˆçš„å­—èŠ‚ç ä½¿ç”¨ Javap è¿›è¡Œåç¼–è¯‘ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public synchronized void testTwo();
  descriptor: ()V
  flags: ACC_PUBLIC, ACC_SYNCHRONIZED
  Code:
    stack&#x3D;2, locals&#x3D;1, args_size&#x3D;1
       0: getstatic     #2                  &#x2F;&#x2F; Field java&#x2F;lang&#x2F;System.out:Ljava&#x2F;io&#x2F;PrintStream;
       3: ldc           #6                  &#x2F;&#x2F; String SynchronizedTest.testTwo() method start!
       5: invokevirtual #4                  &#x2F;&#x2F; Method java&#x2F;io&#x2F;PrintStream.println:(Ljava&#x2F;lang&#x2F;String;)V
       8: return
    LineNumberTable:
      line 23: 0
      line 24: 8
    LocalVariableTable:
      Start  Length  Slot  Name   Signature
          0       9     0  this   Lcom&#x2F;xxx&#x2F;JVMTest&#x2F;SynchronizedTest;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä»åç¼–è¯‘çš„ç»“æœæ¥çœ‹ï¼Œæ–¹æ³•çš„åŒæ­¥å¹¶æ²¡æœ‰é€šè¿‡æŒ‡ä»¤ monitorenter å’Œ monitorexit æ¥å®Œæˆã€‚ç›¸å¯¹äºæ™®é€šæ–¹æ³•ï¼Œå…¶å¸¸é‡æ± ä¸­å¤šäº† ACC_SYNCHRONIZED æ ‡ç¤ºç¬¦ã€‚å®è´¨ä¸Š JVM æ˜¯æ ¹æ®è¯¥æ ‡ç¤ºç¬¦æ¥å®ç°æ–¹æ³•çš„åŒæ­¥çš„ï¼Œå½“æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè°ƒç”¨æŒ‡ä»¤å°†ä¼šæ£€æŸ¥æ–¹æ³•çš„ ACC_SYNCHRONIZED è®¿é—®æ ‡å¿—æ˜¯å¦è¢«è®¾ç½®ï¼Œå¦‚æœè®¾ç½®äº†ï¼Œæ‰§è¡Œçº¿ç¨‹å°†å…ˆè·å– Monitor é”ï¼Œè·å–æˆåŠŸä¹‹åæ‰å»æ‰§è¡Œæ–¹æ³•ä½“ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œå®Œåé‡Šæ”¾ Monitor é”ã€‚åŒæ—¶ï¼Œåœ¨æ–¹æ³•æ‰§è¡ŒæœŸé—´ï¼Œå…¶ä»–ä»»ä½•çº¿ç¨‹éƒ½æ— æ³•å†è·å¾—åŒä¸€ä¸ª Monitor é”å¯¹è±¡ã€‚</p></li><li><p>æ–¹æ³•çš„åŒæ­¥å’Œä»£ç å—çš„åŒæ­¥æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªæ˜¯å…¶ç”¨ä¸€ç§éšå¼çš„æ–¹å¼æ¥å®ç°ï¼Œæ— éœ€é€šè¿‡å­—èŠ‚ç æ¥å®Œæˆã€‚</p></li></ul><h3 id="ä¸‰æ¿æ–§ä¹‹äºŒï¼šéé˜»å¡åŒæ­¥"><a href="#ä¸‰æ¿æ–§ä¹‹äºŒï¼šéé˜»å¡åŒæ­¥" class="headerlink" title="ä¸‰æ¿æ–§ä¹‹äºŒï¼šéé˜»å¡åŒæ­¥"></a>ä¸‰æ¿æ–§ä¹‹äºŒï¼šéé˜»å¡åŒæ­¥</h3><ul><li>æ ¹æ®ä¸Šä¸€å°èŠ‚æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨è¿›è¡Œäº’æ–¥åŒæ­¥æ—¶ï¼Œæ— è®ºå…±äº«çš„æ•°æ®æ˜¯å¦çœŸçš„å­˜åœ¨ç«äº‰ï¼Œå®ƒéƒ½ä¼šè¿›è¡ŒåŠ é”æ“ä½œï¼Œä»è€Œå¯¼è‡´ç”¨æˆ·æ€ä¸æ ¸å¿ƒæ€çš„è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨ä»¥åŠæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…é”çš„çº¿ç¨‹éœ€è¦è¢«å”¤é†’ç­‰é¢å¤–å¼€é”€ï¼Œå› æ­¤äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ã€‚</li><li>é‚£ä¹ˆæ˜¯å¦å­˜åœ¨ä¸€ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œç›®å‰åœ¨ Java ä¸­å®ç°äº†ä¸€ç§åŸºäºå†²çªæ£€æµ‹çš„åŠ é”ç­–ç•¥ â€”â€”â€”â€” CAS æ“ä½œã€‚</li><li>é€šä¿—çš„è¯´å°±æ˜¯å…ˆä¸ç®¡æ˜¯å¦å­˜åœ¨ç«äº‰ï¼Œå…ˆè¿›è¡Œæ“ä½œï¼Œä¸€æ—¦äº§ç”Ÿäº†å†²çªï¼Œå†é€šè¿‡å…¶ä»–è¡¥å¿æ‰‹æ®µè¿›è¡Œä¿®æ­£ã€‚æœ€å¸¸è§çš„å°±æ˜¯é€šè¿‡ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æ²¡æœ‰ç«äº‰ä¸ºæ­¢ã€‚</li><li>è¿™ç§ç­–ç•¥åœ°å¥½å¤„åœ¨äºå…¨ç¨‹æ˜¯å¤„äºç”¨æˆ·æ€ä¸­è¿›è¡Œæ“ä½œï¼Œä»è€Œé¿å…äº†é¢‘ç¹åœ°ç”¨æˆ·æ€ä¸æ ¸å¿ƒæ€ä¹‹é—´çš„åˆ‡æ¢æ“ä½œã€‚</li></ul><ol><li>ç›´åˆ° JDK 5 ï¼Œåœ¨ java.util.concurrent.atomic åŒ…ä¸­æ‰æä¾›äº†ä¸€äº›ç±»æ”¯æŒåŸå­çº§åˆ«çš„ CAS æ“ä½œï¼ŒåŒ…æ‹¬ AtomicBooleanã€AtomicIntegerã€AtomicLong ç­‰ï¼Œè€Œè¿™äº›ç±»çš„æ–¹æ³•å¤§å¤šæ•°åˆæ˜¯è°ƒç”¨çš„ sun.misc.Unsafe ç±»é‡Œé¢çš„ compareAndSwapInt() å’Œ compareAndSwapLong() ç­‰å‡ ä¸ªä¿è¯åŸå­æ“ä½œçš„æ–¹æ³•ã€‚</li></ol><ul><li><p>ä»¥ java.util.concurrent.atomic.AtomicInteger ç±»çš„ getAndIncrement() æ–¹æ³•ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public class AtomicInteger extends Number implements java.io.Serializable &#123;

    static &#123;
        try &#123;
            &#x2F;&#x2F;è·å– value å˜é‡çš„åç§»é‡, èµ‹å€¼ç»™ valueOffset
            valueOffset &#x3D; unsafe.objectFieldOffset
                (AtomicInteger.class.getDeclaredField(&quot;value&quot;));
        &#125; catch (Exception ex) &#123; throw new Error(ex); &#125;
    &#125;

    &#x2F;**
     * Atomically increments by one the current value.
     *
     * @return the previous value
     *&#x2F;
    public final int getAndIncrement() &#123;
        return unsafe.getAndAddInt(this, valueOffset, 1);
    &#125;

    ...other methods...
&#125;

&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

public final class Unsafe &#123;
    public final int getAndAddInt(Object var1, long var2, int var4) &#123;
        int var5;
        do &#123;
            &#x2F;&#x2F;é€šè¿‡å¯¹è±¡å’Œåç§»é‡è·å–å˜é‡çš„å€¼
    	    &#x2F;&#x2F;ç”±äº volatile çš„ä¿®é¥°, å› æ­¤æ‰€æœ‰çº¿ç¨‹çœ‹åˆ°çš„ var5 éƒ½æ˜¯ä¸€æ ·çš„
            var5 &#x3D; this.getIntVolatile(var1, var2);
        &#125; while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));

        return var5;
    &#125;

    ...other methods...
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Unsafe ç±»çš„ getAndAddInt() æ–¹æ³•ä¸­å­˜åœ¨ä¸€ä¸ª do while å¾ªç¯ï¼Œè€Œå¾ªç¯æ¡ä»¶ä¸­çš„ compareAndSwapInt() æ–¹æ³•ä¼šä»¥åŸå­çš„æ–¹å¼å°è¯•ä¿®æ”¹ var5 çš„å€¼ã€‚</p></li><li><p>å…·ä½“è€Œè¨€ï¼Œè¯¥æ–¹æ³•é€šè¿‡ obj å’Œ valueOffset è·å–å˜é‡çš„å€¼ï¼Œå¦‚æœè¿™ä¸ªå€¼å’Œ var5 ä¸ä¸€æ ·ï¼Œè¯´æ˜å…¶ä»–çº¿ç¨‹å·²ç»å…ˆä¸€æ­¥ä¿®æ”¹äº† obj + valueOffset åœ°å€å¤„çš„å€¼ï¼Œæ­¤æ—¶ compareAndSwapInt() è¿”å› falseï¼Œç»§ç»­å¾ªç¯ï¼›å¦‚æœè¿™ä¸ªå€¼å’Œ var5 ä¸€æ ·ï¼Œè¯´æ˜æ²¡æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹ obj + valueOffset åœ°å€å¤„çš„å€¼ï¼Œæ­¤æ—¶å¯ä»¥å°† obj + valueOffset åœ°å€å¤„çš„å€¼æ”¹ä¸º var5 + var4 ï¼ŒcompareAndSwapInt() è¿”å› trueï¼Œé€€å‡ºå¾ªç¯ã€‚ç”±äº compareAndSwapInt() æ–¹æ³•æ˜¯åŸå­æ“ä½œ, æ‰€ä»¥compareAndSwapInt() ä¿®æ”¹ obj + valueOffset åœ°å€å¤„çš„å€¼æ—¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ã€‚</p></li></ul><ol start="2"><li>é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½¿ç”¨ CAS æ¥å®ç°åŒæ­¥æ“ä½œä¹Ÿå¼•å‘äº†ä¸€äº›æ–°çš„é—®é¢˜ï¼š</li></ol><ul><li>å¦‚æœè‡ªæ—‹ CAS é•¿æ—¶é—´ä¸æˆåŠŸï¼Œå°±ä¼šç™½ç™½æµªè´¹æœ¬æ¥å°±å®è´µçš„ CPU æ—¶é—´ï¼›</li><li>ç†è®ºä¸Šè€Œè¨€ï¼ŒCAS ä¹Ÿåªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼ŒåŠŸèƒ½ä¸Šå¹¶æ²¡æœ‰ synchronized åŒæ­¥ä»£ç å—ä¸°å¯Œï¼›</li><li>ABAé—®é¢˜ï¼šæˆ‘ä»¬å¯ä»¥å‡è®¾è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œå¦‚æœä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œä¹‹ååˆå˜å›äº†Aï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨ CAS æ“ä½œè¿›è¡Œæ£€æŸ¥æ—¶ä¼šå‡ºç°ä»¥ä¸ºå®ƒçš„å€¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè€Œå®é™…ä¸Šå·²ç»å˜åŒ–äº†çš„æƒ…å†µã€‚ä¸è¿‡å®é™…ä¸Šå³ä½¿å‡ºç°äº† ABA é—®é¢˜åœ¨å¤§éƒ¨åˆ†å¹¶å‘æƒ…å†µä¸‹ä¹Ÿä¸ä¼šå½±å“ç¨‹åºçš„å¹¶å‘æ­£ç¡®æ€§ï¼Œå¦‚æœè¯å®ç¡®å®å­˜åœ¨å½±å“ï¼Œé‚£ä¹ˆæœ€å¥½æ”¹ç”¨ synchronized åŒæ­¥ä»£ç å—æ¥å®ç°åŒæ­¥æ“ä½œã€‚</li></ul><h3 id="ä¸‰æ¿æ–§ä¹‹ä¸‰ï¼šæ— åŒæ­¥çº¿ç¨‹å®‰å…¨"><a href="#ä¸‰æ¿æ–§ä¹‹ä¸‰ï¼šæ— åŒæ­¥çº¿ç¨‹å®‰å…¨" class="headerlink" title="ä¸‰æ¿æ–§ä¹‹ä¸‰ï¼šæ— åŒæ­¥çº¿ç¨‹å®‰å…¨"></a>ä¸‰æ¿æ–§ä¹‹ä¸‰ï¼šæ— åŒæ­¥çº¿ç¨‹å®‰å…¨</h3><ul><li>å…¶å®ï¼ŒåŒæ­¥ä¸å¦ä¸æ˜¯å¦çº¿ç¨‹å®‰å…¨æ²¡æœ‰å¿…ç„¶è”ç³»ï¼ŒåŒæ­¥åªæ˜¯å®ç°çº¿ç¨‹å®‰å…¨çš„ä¸€ç§æ‰‹æ®µï¼Œå¦‚æœå­˜åœ¨æœ‰ç«äº‰çš„å…±äº«æ•°æ®é‚£ä¹ˆä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ä¹Ÿä¸å¤±ä¸ºä¸€ç§å¥½çš„æ–¹æ¡ˆï¼Œä½†å¦‚æœæœ¬æ¥å°±ä¸å­˜åœ¨ç«äº‰çš„å¯èƒ½ï¼Œé‚£å®ƒæœ¬èº«å°±æœ‰éšå¼çš„çº¿ç¨‹å®‰å…¨ä¿è¯ã€‚</li></ul><ol><li><p>å¯é‡å…¥ä»£ç ï¼ˆçº¯ä»£ç ï¼‰</p><blockquote><p>æ˜¯ä¸€ç§å…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®çš„ä»£ç ã€‚ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è¢«æ‰“æ–­ï¼Œå¹¶ç”±å¼€å§‹å¤„å†æ¬¡æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨åˆç†çš„èŒƒå›´å†…ï¼ˆå¤šæ¬¡é‡å…¥ï¼Œè€Œä¸é€ æˆå †æ ˆæº¢å‡ºç­‰å…¶ä»–é—®é¢˜ï¼‰ï¼Œç¨‹åºå¯ä»¥åœ¨è¢«æ‰“æ–­å¤„ç»§ç»­æ‰§è¡Œï¼Œä¸”æ‰§è¡Œç»“æœä¸å—å½±å“ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%AF%E9%87%8D%E5%85%A5%E4%BB%A3%E7%A0%81/1955592?fr=aladdin">å¯é‡å…¥ä»£ç  | ç™¾åº¦ç™¾ç§‘</a>ï¼‰</p></blockquote></li><li><p>å¯é‡å…¥ä»£ç æ‹¥æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼š</p></li></ol><ul><li>ä¸ä¾èµ–å…¨å±€å˜é‡ï¼›</li><li>ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºï¼›</li><li>ä½¿ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¼ å…¥ï¼›</li><li>ä¸è°ƒç”¨å…¶ä»–éå¯é‡å…¥çš„æ–¹æ³•ï¼›<br>â€¦â€¦</li></ul><ol start="3"><li><p>å› æ­¤ï¼Œå¦‚æœä¸€æ®µä»£ç ä¸­å­˜åœ¨ä¸å…¶ä»–ä»£ç çš„å…±äº«å˜é‡ï¼Œåªè¦èƒ½ä¿è¯è¿™äº›å˜é‡çš„å¯è§èŒƒå›´åªåœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œé‚£ä¹ˆæ— éœ€åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´çš„æ•°æ®å®‰å…¨æ€§ã€‚</p></li><li><p>åœ¨ Java ä¸­ï¼Œä½¿ç”¨äº† java.lang.ThreadLocal ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨çš„åŠŸèƒ½ï¼Œæ¯ä¸ªçº¿ç¨‹çš„ Thread å¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ª ThreadLocalMap å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å­˜å‚¨äº†ä¸€ç»„ä»¥ ThreadLocal.threadLocalHashCode ä¸ºé”®ï¼Œä»¥æœ¬åœ°çº¿ç¨‹å˜é‡ä¸ºå€¼çš„ K - v é”®å€¼å¯¹ã€‚ç”±äºæ¯ä¸ªçº¿ç¨‹çš„ ThreadLocal.threadLocalHashCode çš„å€¼éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå› æ­¤æ‰€æ˜ å°„çš„å€¼ä¹Ÿåªèƒ½è¯¥çº¿ç¨‹è‡ªå·±æ‰èƒ½è®¿é—®åˆ°ï¼Œä¹Ÿå°±å®ç°äº†çº¿ç¨‹å®‰å…¨ã€‚</p></li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li>å¯ä»¥ä½¿ç”¨äº’æ–¥åŒæ­¥ï¼ˆé˜»å¡åŒæ­¥ï¼‰çš„æ–¹å¼ï¼Œå®ç°å…±äº«å˜é‡çš„çº¿ç¨‹å®‰å…¨ï¼Œå…¸å‹ä¾‹å­åŒ…æ‹¬ï¼šsynchronized ç­‰;</li><li>å¯ä»¥ä½¿ç”¨è‡ªæ—‹ CAS çš„æ–¹å¼ï¼Œå®ç°å…±äº«å˜é‡çš„çº¿ç¨‹å®‰å…¨ï¼Œå…¸å‹ä¾‹å­åŒ…æ‹¬ï¼šsun.misc.Unsafe ç±»ã€java.util.concurrent.atomic åŒ…ä¸­çš„ AtomicBooleanã€AtomicIntegerã€AtomicLong ç­‰ï¼›</li><li>å¦‚æœå¯ä»¥ä¿è¯å…±äº«å˜é‡çš„å¯è§èŒƒå›´å‡åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œé‚£ä¹ˆå…¶æœ¬èº«å°±å¸¦æœ‰éšå¼çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œä¸éœ€è¦å†åšå…¶ä»–æ˜¾å¼çš„åŒæ­¥æ“ä½œã€‚</li></ol><h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><ol><li>æ–¹è…¾é£, é­é¹, ç¨‹æ™“æ˜ï¼Javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ [M]. åŒ—äº¬ï¼šæœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾ï¼Œ2015ï¼š11-20.</li><li>å‘¨å¿—æ˜ï¼æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº: JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆ3 ç‰ˆï¼‰[M]. åŒ—äº¬ï¼šæœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾ï¼Œ2019ï¼š471-478.</li></ol><blockquote><p>è¯»ä¹¦ä¸è§‰å·²æ˜¥æ·±ï¼Œä¸€å¯¸å…‰é˜´ä¸€å¯¸é‡‘ã€‚</p></blockquote></div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§çš„åŠ¨åŠ›.</div><div id="qr" style="display:none"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://z3.ax1x.com/2021/09/25/4sPRde.jpg"><img loading="lazy" src="https://z3.ax1x.com/2021/09/25/4sPRde.jpg" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00a3ee"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://z3.ax1x.com/2021/09/25/4sPrxx.png"><img loading="lazy" src="https://z3.ax1x.com/2021/09/25/4sPrxx.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2dc100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>ONESTONE</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://www.onexstone.online/posts/cf2f473d/" title="Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§">https://www.onexstone.online/posts/cf2f473d/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a>è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/posts/fa978b73/" rel="prev" title="HotSpotå¯¹synchronizedçš„é”ä¼˜åŒ–ç­–ç•¥"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">HotSpotå¯¹synchronizedçš„é”ä¼˜åŒ–ç­–ç•¥</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/posts/e0afdf66/" rel="next" title="ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å°ç«™"><span class="post-nav-text">ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å°ç«™</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è¦ä¸è¦å’Œæˆ‘è¯´äº›ä»€ä¹ˆï¼Ÿ</span><br></div><div id="waline"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js",()=>{const e={enable:!0,serverURL:"https://my-blogs-comment-system-gkgzbdn2n-horizon-x.vercel.app",visitor:!0,comment:!0,el:"#waline",lang:"zh-CN",path:"/posts/cf2f473d/",dark:'html[data-user-color-scheme="dark"]',emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-flag","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-weather","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/alus","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tieba"],avatar:"identicon"};new Waline(e)},window.Waline)</script></div><script src="/js/fancybox/jquery.fancybox.min.js"></script><script src="/js/fancybox/wrapImage.js"></script></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">äº¬ICPå¤‡2021017712å·</a></div><div class="copyright"><span>&copy; 2021 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="http://onexstone.online" title="about me"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><span class="author">ONESTONE</span><spen>|</spen><script>function blog_cnzz_analytics(){document.write(unescape("%3Cspan id='cnzz_stat_icon_1280383522'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1280383522' type='text/javascript'%3E%3C/script%3E"))}blog_cnzz_analytics()</script></div><div class="live_time"><span>æœ¬å°ç«™å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time(){setTimeout(blog_live_time,1e3);const e=new Date("2021-09-24T00:00:00"),t=new Date;var i=t.getTime()-e.getTime(),o=Math.floor(i/864e5),l=Math.floor(i%864e5/60/60/1e3),a=Math.floor(i%36e5/60/1e3),i=Math.floor(i%6e4/1e3);display_live_time.innerHTML=" "+o+" å¤© "+l+" å°æ—¶ "+a+" åˆ† "+i+" ç§’"}blog_live_time()</script></div><div class="footer-custom-text">Hosted by <a href="https://github.com/Horizon-x/Horizon-x.github.io" rel="noopener" target="_blank">GitHub Pages</a> & <a href="https://coding.net" rel="noopener" target="_blank">Coding Pages</a></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded",()=>{document.querySelector(".popup-trigger").addEventListener("click",()=>{document.querySelector(".popup").classList.add("show"),setTimeout(()=>{document.querySelector(".search-input").focus()},100)});const t=()=>{document.querySelector(".popup").classList.remove("show")};document.querySelector(".popup-btn-close").addEventListener("click",()=>{t()}),window.addEventListener("keyup",e=>{"Escape"===e.key&&t()})})</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Search or jump to..."></div><div id="local-search-result"></div></div></div><script src="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.1.1/js/index.js"></script><div id="widget-tree"><ul><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/Java/">Java</a><ul class="tree-list-children"><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/Java/JVM/">JVM</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/d4cbe240/" title="Javaå¯¹è±¡å¼•ç”¨çš„ç»†åŒ–"><i class="post-icon gg-file-document"></i>Javaå¯¹è±¡å¼•ç”¨çš„ç»†åŒ–</a></li></ul></li><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/Java/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">Javaå¹¶å‘ç¼–ç¨‹</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/fa978b73/" title="HotSpotå¯¹synchronizedçš„é”ä¼˜åŒ–ç­–ç•¥"><i class="post-icon gg-file-document"></i>HotSpotå¯¹synchronizedçš„é”ä¼˜åŒ–ç­–ç•¥</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/cf2f473d/" title="Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§"><i class="post-icon gg-file-document"></i>Javaä¸­ä¿è¯çº¿ç¨‹å®‰å…¨çš„ä¸‰æ¿æ–§</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/369cb3ec/" title="æ·±å…¥å‰–ævolatileå…³é”®å­—"><i class="post-icon gg-file-document"></i>æ·±å…¥å‰–ævolatileå…³é”®å­—</a></li></ul></li></ul></li><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/MyBlogs%E7%B3%BB%E5%88%97/">MyBlogsç³»åˆ—</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/e0afdf66/" title="ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å°ç«™"><i class="post-icon gg-file-document"></i>ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å°ç«™</a></li></ul></li><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/Reprint/">Reprint</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/d78266f6/" title="9ä¸ªä¸»æµçš„å¼€æºè®¸å¯åè®®"><i class="post-icon gg-file-document"></i>9ä¸ªä¸»æµçš„å¼€æºè®¸å¯åè®®</a></li></ul></li><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/Spring/">Spring</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/78dbede3/" title="å¿«é€Ÿæ­å»ºä¸€ä¸ªç®€æ˜“çš„SpringBooté¡¹ç›®"><i class="post-icon gg-file-document"></i>å¿«é€Ÿæ­å»ºä¸€ä¸ªç®€æ˜“çš„SpringBooté¡¹ç›®</a></li></ul></li><li class="tree-list-item"><i class="toggle-post-icon gg-folder-add"></i><a class="tree-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/">ç½‘ç»œåè®®</a><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/posts/d9c27918/" title="HTTPåè®®ä¹‹çŠ¶æ€ç "><i class="post-icon gg-file-document"></i>HTTPåè®®ä¹‹çŠ¶æ€ç </a></li></ul></li></ul><div id="widget-tree-button"><i class="gg-chevron-right"></i></div></div><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script><script data-pjax>function GithubCalendarConfig(){var e=document.getElementById("calendar-main-inner");e&&"/about/"==location.pathname&&(console.log("å·²æŒ‚è½½github calendar"),e.insertAdjacentHTML("afterbegin",'<div class="post-block animated fadeIn" style="width:100%;height:auto;padding:40px 10px 10px 10px;"><div id="github_loading" style="height:100%;display: flex;align-items: center;justify-content: center;"><svg style="height:50px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div><footer class="post-footer"><div class="post-eof"></div></footer>')),GithubCalendar("https://python-github-calendar-api.vercel.app/api?Horizon-x",["#ebedf0","#f1f8ff","#dbedff","#c8e1ff","#79b8ff","#2188ff","#0366d6","#005cc5","#044289","#032f62","#05264c"],"Horizon-x")}document.getElementById("calendar-main-inner")&&GithubCalendarConfig()</script><style>#github_container{min-height:280px}@media screen and (max-width:650px){#github_container{min-height:0}}</style><style></style><script src="https://cdn.jsdelivr.net/npm/live2d-widget@^3.1.3/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"https://cdn.jsdelivr.net/npm/live2d-widget-model-haruto@1.0.5/assets/haruto.model.json"},display:{position:"right",width:150,height:300},mobile:{show:!0},react:{opacity:.7},log:!1})</script><script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BN_dQoGLHrUXi0sHhuNwHGJlh9VryLBiBmPZ_dpECgQzkdUCH_kZA7-PYzh7LUIpFM9A9HIoh-kwANh97KlaL-o' });</script></body></html>